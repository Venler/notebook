## 网页生成的过程

1. HTML代码转成Dom
2. css代码转成CSSom
3. 结合DOM和CSSOM，生产一棵渲染树
4. 生成布局，将所有渲染树的所有节点进行平面合成
5. 将布局绘制（paint）在屏幕上

这五步里面，第一步到第三步都非常快，耗时的是第四步和第五步。

**"生成布局"（flow）和"绘制"（paint）这两步，合称为"渲染"（render）。**

重排和重绘会不断触发，这是不可避免的。但是，它们非常耗费资源，是导致网页性能低下的根本原因。

**提高网页性能，就是要降低"重排"和"重绘"的频率和成本，尽量少触发重新渲染。**

一般的规则是：

> * 样式表越简单，重排和重绘就越快。
> * 重排和重绘的DOM元素层级越高，成本就越高。
> * table元素的重排和重绘成本，要高于div元素

## 提高性能的九个技巧（重排和重绘角度）

**第一条**

是上一节说到的，DOM 的多个读操作（或多个写操作），应该放在一起。不要两个读操作之间，加入一个写操作。

**第二条**

如果某个样式是通过重排得到的，那么最好缓存结果。避免下一次用到的时候，浏览器又要重排。

**第三条**

不要一条条地改变样式，而要通过改变class，或者csstext属性，一次性地改变样式。

**第四条**

尽量使用离线DOM，而不是真实的网面DOM，来改变元素样式。比如，操作Document Fragment对象，完成后再把这个对象加入DOM。再比如，使用 cloneNode\(\) 方法，在克隆的节点上进行操作，然后再用克隆的节点替换原始节点。

**第五条**

先将元素设为`display: none（`需要1次重排和重绘），然后对这个节点进行100次操作，最后再恢复显示（需要1次重排和重绘）。这样一来，你就用两次重新渲染，取代了可能高达100次的重新渲染。

**第六条**

position属性为`absolute`或`fixed`的元素，重排的开销会比较小，因为不用考虑它对其他元素的影响。

**第七条**

只在必要的时候，才将元素的display属性为可见，因为不可见的元素不影响重排和重绘。另外，`visibility : hidden`的元素只对重绘有影响，不影响重排。

## 提高性能（动画相关）

**一秒之间能够完成多少次重新渲染，这个指标就被称为"刷新率"，英文为FPS（frame per second）。**60次重新渲染，就是60FPS。

如果想达到60帧的刷新率，就意味着JavaScript线程每个任务的耗时，必须少于16毫秒。一个解决办法是使用Web Worker，主线程只用于UI渲染，然后跟UI渲染不相干的任务，都放在Worker线程。

1.window.requestAnimationFrame\(\) 方法

## 提高性能（网络相关）

1.减少http请求数量

\(1\)   减少服务器压力.

\(2\)   减少http请求头

当我们对服务器发起一个请求的时候,我们会携带着这个域名下的cookie和一些其他的信息在http头部里,然后服务器响应请求的时候也会带回一些cookie之类的头部信息.这些信息有的时候会很大,在这种请求和响应的时候会影响带宽性能.

\(3\)   减少DNS请求所耗费的时间.

当我们去请求一个url的时候,首先会到本地服务器里去寻找缓存中是否有解析结果,如果没有解析结果,就去根域名服务器请求,根域名服务器返回给本 地域名服务器一个所查询的域的主域名服务器的ip地址,然后我们再去请求刚才返回的ip地址的域名服务器,然后返回下一级域名的ip地址,直到我们找到域 名中所指的服务器ip,然后将结果缓存起来供下次使用,并返回此结果



